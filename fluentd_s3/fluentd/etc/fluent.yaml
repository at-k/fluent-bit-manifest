# AUTOMATICALLY GENERATED
# DO NOT EDIT THIS FILE DIRECTLY, USE /templates/conf/fluent.conf.erb
apiVersion: v1
kind: ConfigMap
metadata:
  name: fluent-conf
  namespace: kube-system
data:
  fluent.conf: |
    @include "#{ENV['FLUENTD_SYSTEMD_CONF'] || 'systemd'}.conf"
    @include "#{ENV['FLUENTD_PROMETHEUS_CONF'] || 'prometheus'}.conf"
    @include kubernetes.conf
    @include conf.d/*.conf

    <source>
      @type forward
    </source>

    <match test.**>
      @type stdout
    </match>

    <match kubernetes.var.log.containers.**fluentd**.log>
      @type null
    </match>
    <filter kubernetes.**>
      @type record_transformer
      enable_ruby
      <record>
        hoge ${tag_parts[4]}
        test ${record.dig("kubernetes", "namespace_name")}
      </record>
    </filter>
    <match kubernetes.**>
      @type stdout
      include_tag_key true

      <buffer>
        flush_interval 5s
      </buffer>
    </match>
